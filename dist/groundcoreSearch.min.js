!function(e){e.fn.groundcoreSearch=function(r){function t(r){var t=r,n=new RegExp(t,"i"),o="",d=0,u=0;e.each(a,function(e,r){s.searchConditions(r,n)&&(o+=s.renderItem(r),u++),d++}),0==u&&(o=s.renderNoResults()),i.html(o)}function n(r){var t=e.ajax({ifModified:!0,dataType:"json",data:s.data,method:s.method,url:s.searchUrl});t.done(function(e){a=e,r.trigger("groundcoreSearch:data:loaded")}),t.fail(function(e){console.log(e.message),alert(e.message)})}var a,o={searchUrl:!1,appendResultTo:!1,resultWrapperAttrs:{id:"groundcore-search-result",class:"list-group"},resultWrapperCss:{},method:"GET",data:{},limit:25,searchConditions:function(e,r){return-1!=e.nome.search(r)||-1!=e.comune.nome.search(r)},renderItem:function(e){return"<div>"+e.nome+"</div>"},renderNoResults:function(){return'<ul class="list-group"><li class="list-group-item">Nessun risultato.</li></ul>'}},s=e.extend(!0,{},o,r),i=e("<div />").attr(s.resultWrapperAttrs).css(s.resultWrapperCss);!function(r){e(r).attr("disabled",!0),s.appendResultTo?e(s.appendResultTo).append(i):r.parents(".form-group").after(i),0==s.searchUrl&&alert("[groundcoreSearch] Option searchUrl not set."),n(r)}(this),this.on("keyup",function(e){13==e.keyCode&&e.preventDefault();var r=new RegExp("^[a-zA-Z0-9]+$"),n=String.fromCharCode(e.charCode?e.charCode:e.which),a=this.value;a.trim().length<3&&i.empty(),a.trim().length>2&&a.trim().length<30&&(r.test(n)||8==e.keyCode)&&t(a)}),this.on("groundcoreSearch:data:loaded",function(r){e(this).attr("disabled",!1)})}}(jQuery);